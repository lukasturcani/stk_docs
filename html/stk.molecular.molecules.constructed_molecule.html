

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Constructed Molecule &mdash; stk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">stk</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_examples.html">Basic Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Molecules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.molecules.building_block.html">Building Block</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Constructed Molecule</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.functional_groups.html">Functional Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.populations.html">Populations</a></li>
</ul>
<p class="caption"><span class="caption-text">Topology Graphs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.polymer.html">Polymer</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.cage.base.html">Organic Cage</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.cof.html">Covalent Organic Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.host_guest.html">Host Guest Complex</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.macrocycle.html">Macrocycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.rotaxane.html">Rotaxane</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html">Adding Topology Graphs</a></li>
</ul>
<p class="caption"><span class="caption-text">Calculators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="calculators.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.optimization.optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.energy.energy_calculators.html">Energy Calculators</a></li>
</ul>
<p class="caption"><span class="caption-text">Evolutionary Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ea.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.fitness_calculators.html">Fitness Calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.fitness_normalizers.html">Fitness Normalizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.selectors.html">Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.mutators.html">Mutation</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.crossers.html">Crossover</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.plotters.html">Plotting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Constructed Molecule</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.molecular.molecules.constructed_molecule.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-stk.molecular.molecules.constructed_molecule"></span><div class="section" id="constructed-molecule">
<h1>Constructed Molecule<a class="headerlink" href="#constructed-molecule" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule">
<em class="property">class </em><code class="sig-name descname">ConstructedMolecule</code><span class="sig-paren">(</span><em class="sig-param">building_blocks</em>, <em class="sig-param">topology_graph</em>, <em class="sig-param">building_block_vertices=None</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.molecule.Molecule</span></code></a></p>
<p>Represents constructed molecules.</p>
<p>A <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> requires at least 2 basic pieces of
information: which building block molecules are used to construct
the molecule and what the <a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a> of the
constructed molecule is. The construction of the molecular
structure is performed by <a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph.construct" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph.construct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TopologyGraph.construct()</span></code></a>. This
method does not have to be called explicitly by the user, it will
be called automatically during initialization.</p>
<p>The building block molecules used for construction can be either
<a class="reference internal" href="stk.molecular.molecules.building_block.html#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> instances or other
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> instances, or a combination both.</p>
<p>Each <a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a> subclass may add additional attributes
to the <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>, which will be described within
its documentation.</p>
<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.atoms">
<code class="sig-name descname">atoms</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>The atoms of the molecule. Each <a class="reference internal" href="stk.molecular.elements.html#stk.molecular.elements.Atom" title="stk.molecular.elements.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>
instance is guaranteed to have two attributes. The
first is <code class="xref py py-attr docutils literal notranslate"><span class="pre">building_block</span></code>, which holds the building
block <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> from which that
<a class="reference internal" href="stk.molecular.elements.html#stk.molecular.elements.Atom" title="stk.molecular.elements.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> came. If the <a class="reference internal" href="stk.molecular.elements.html#stk.molecular.elements.Atom" title="stk.molecular.elements.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> did not come from a
building block, but was added by a reaction, the value
of this attribute will be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>The second attribute is <code class="xref py py-attr docutils literal notranslate"><span class="pre">building_block_id</span></code>.
This will be the same value on all atoms that came from the
building block. Note that if a building block is used multiple
times during construction, the <code class="xref py py-attr docutils literal notranslate"><span class="pre">building_block_id</span></code> will
be different for each time it is used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.elements.html#stk.molecular.elements.Atom" title="stk.molecular.elements.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.bonds">
<code class="sig-name descname">bonds</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>The bonds of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.bonds.html#stk.molecular.bonds.Bond" title="stk.molecular.bonds.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.building_block_vertices">
<code class="sig-name descname">building_block_vertices</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.building_block_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps the <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> instances used for construction,
which can be either <a class="reference internal" href="stk.molecular.molecules.building_block.html#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> or
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>, to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code> objects they are placed on
during construction. The <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">building_block_vertices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">BuildingBlock</span><span class="p">(</span><span class="o">...</span><span class="p">):</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">),</span> <span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">)],</span>
    <span class="n">BuildingBlock</span><span class="p">(</span><span class="o">...</span><span class="p">):</span> <span class="p">[</span>
        <span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>
        <span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>
        <span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">ConstructedMolecule</span><span class="p">(</span><span class="o">...</span><span class="p">):</span> <span class="p">[</span><span class="n">Vertex</span><span class="p">(</span><span class="o">...</span><span class="p">)]</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.building_block_counter">
<code class="sig-name descname">building_block_counter</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.building_block_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>A counter keeping track of how many times each building block
molecule appears in the <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">collections.Counter</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.topology_graph">
<code class="sig-name descname">topology_graph</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.topology_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the topology graph of <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> and
is responsible for constructing it.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.construction_bonds">
<code class="sig-name descname">construction_bonds</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.construction_bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds the bonds in <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.bonds" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.bonds"><code class="xref py py-attr docutils literal notranslate"><span class="pre">bonds</span></code></a>, which were added by the
construction process.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.bonds.html#stk.molecular.bonds.Bond" title="stk.molecular.bonds.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.func_groups">
<code class="sig-name descname">func_groups</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.func_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>The remnants of building block functional groups present in the
molecule. They track which atoms belonged to functional groups
in the building block molecules. The id of each
<a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> should match its index in
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.func_groups" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p><em>Initialization</em></p>
<p>A <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> can be created from a set of
building blocks and a <a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">stk</span>

<span class="n">bb1</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">BuildingBlock</span><span class="p">(</span><span class="s1">&#39;NCCCN&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;amine&#39;</span><span class="p">])</span>
<span class="n">bb2</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">BuildingBlock</span><span class="p">(</span><span class="s1">&#39;O=CC(C=O)CC=O&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;aldehyde&#39;</span><span class="p">])</span>
<span class="n">tetrahedron</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">cage</span><span class="o">.</span><span class="n">FourPlusSix</span><span class="p">()</span>
<span class="n">cage1</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">ConstructedMolecule</span><span class="p">(</span>
    <span class="n">building_blocks</span><span class="o">=</span><span class="p">[</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">],</span>
    <span class="n">topology_graph</span><span class="o">=</span><span class="n">tetrahedron</span>
<span class="p">)</span>
</pre></div>
</div>
<p>A <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> can be used to construct other
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> instances</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">benzene</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">BuildingBlock</span><span class="p">(</span><span class="s1">&#39;c1ccccc1&#39;</span><span class="p">)</span>
<span class="n">cage_complex</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">ConstructedMolecule</span><span class="p">(</span>
    <span class="n">building_blocks</span><span class="o">=</span><span class="p">[</span><span class="n">cage1</span><span class="p">,</span> <span class="n">benzene</span><span class="p">],</span>
    <span class="n">topology_graph</span><span class="o">=</span><span class="n">stk</span><span class="o">.</span><span class="n">host_guest</span><span class="o">.</span><span class="n">Complex</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<p>During initialization it is possible to force building blocks to
be placed on specific <a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph.vertices" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph.vertices"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vertices</span></code></a> of the
<a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bb3</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">BuildingBlock</span><span class="p">(</span><span class="s1">&#39;NCOCN&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;amine&#39;</span><span class="p">])</span>
<span class="n">bb4</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">BuildingBlock</span><span class="p">(</span><span class="s1">&#39;NCOCCCOCN&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;amine&#39;</span><span class="p">])</span>
<span class="n">cage2</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">ConstructedMolecule</span><span class="p">(</span>
    <span class="n">building_blocks</span><span class="o">=</span><span class="p">[</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">,</span> <span class="n">bb3</span><span class="p">,</span> <span class="n">bb4</span><span class="p">],</span>
    <span class="n">topology_graph</span><span class="o">=</span><span class="n">tetrahedron</span>
    <span class="n">building_block_vertices</span><span class="o">=</span><span class="p">{</span>
        <span class="n">bb1</span><span class="p">:</span> <span class="n">tetrahedron</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">bb3</span><span class="p">:</span> <span class="n">tetrahedron</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">bb4</span><span class="p">:</span> <span class="n">tetrahedron</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p><em>Building blocks with the wrong number of functional groups.</em></p>
<p>If the building block has too many functional groups, you can
remove some in order to use it</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">chain</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">polymer</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>  <span class="mi">3</span><span class="p">)</span>

<span class="c1"># This won&#39;t work, bb2 has 3 functional groups but 2 are needed</span>
<span class="c1"># for monomers in a linear polymer chain.</span>
<span class="n">failed</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">ConstructedMolecule</span><span class="p">(</span>
    <span class="n">building_blocks</span><span class="o">=</span><span class="p">[</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">],</span>
    <span class="n">topology_graph</span><span class="o">=</span><span class="n">chain</span>
<span class="p">)</span>

<span class="c1"># Remove one of the functional groups and you will be able to</span>
<span class="c1"># construct the chain.</span>
<span class="n">bb2</span><span class="o">.</span><span class="n">func_groups</span> <span class="o">=</span> <span class="p">(</span><span class="n">bb2</span><span class="o">.</span><span class="n">func_groups</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bb2</span><span class="o">.</span><span class="n">func_groups</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">failed</span> <span class="o">=</span> <span class="n">stk</span><span class="o">.</span><span class="n">ConstructedMolecule</span><span class="p">(</span>
    <span class="n">building_blocks</span><span class="o">=</span><span class="p">[</span><span class="n">bb1</span><span class="p">,</span> <span class="n">bb2</span><span class="p">],</span>
    <span class="n">topology_graph</span><span class="o">=</span><span class="n">chain</span>
<span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_displacement" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_displacement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_displacement</span></code></a>(self, displacement)</p></td>
<td><p>Shift the centroid by <cite>displacement</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_about_axis" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_about_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_about_axis</span></code></a>(self, angle, axis, …)</p></td>
<td><p>Rotate by <cite>angle</cite> about <cite>axis</cite> on the <cite>origin</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_between_vectors" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_between_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_between_vectors</span></code></a>(self, start, …)</p></td>
<td><p>Rotate by a rotation from <cite>start</cite> to <cite>target</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_to_minimize_angle" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_to_minimize_angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_to_minimize_angle</span></code></a>(self, …)</p></td>
<td><p>Rotate to minimize the angle between <cite>start</cite> and <cite>target</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.dump" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a>(self, path[, include_attrs, …])</p></td>
<td><p>Write a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_coords" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_coords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_atom_coords</span></code></a>(self[, atom_ids])</p></td>
<td><p>Yield the coordinates of atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_distance" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_atom_distance</span></code></a>(self, atom1_id, atom2_id)</p></td>
<td><p>Return the distance between 2 atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_building_blocks" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_building_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_building_blocks</span></code></a>(self)</p></td>
<td><p>Yield the building blocks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_cached_mol" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_cached_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cached_mol</span></code></a>(identity_key[, default])</p></td>
<td><p>Get a molecule from the cache.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_center_of_mass" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_center_of_mass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_center_of_mass</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the centre of mass.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_centroid" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the centroid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_direction" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_direction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_direction</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return a vector of best fit through the atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_identity_key" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_identity_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_identity_key</span></code></a>(self)</p></td>
<td><p>Return the identity key.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_maximum_diameter" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_maximum_diameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_maximum_diameter</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the maximum diamater.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_plane_normal" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_plane_normal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_plane_normal</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the normal to the plane of best fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_position_matrix" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_position_matrix</span></code></a>(self)</p></td>
<td><p>Return a matrix holding the atomic positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.has_cached_mol" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.has_cached_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_cached_mol</span></code></a>(identity_key)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if molecule with <cite>identity_key</cite> is cached.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.init_from_dict" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.init_from_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_from_dict</span></code></a>(mol_dict[, use_cache])</p></td>
<td><p>Initialize from a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.load" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path[, use_cache])</p></td>
<td><p>Initialize from a dump file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_centroid" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_centroid</span></code></a>(self, position[, atom_ids])</p></td>
<td><p>Set the centroid to <cite>position</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_position_matrix" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_position_matrix</span></code></a>(self, position_matrix)</p></td>
<td><p>Set the coordinates to those in <cite>position_matrix</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dict</span></code></a>(self[, include_attrs, …])</p></td>
<td><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_rdkit_mol" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_rdkit_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_rdkit_mol</span></code></a>(self)</p></td>
<td><p>Return an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_cache" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_cache"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_cache</span></code></a>(self)</p></td>
<td><p>Update attributes of the cached molecule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_file" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_from_file</span></code></a>(self, path)</p></td>
<td><p>Update the structure from a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_rdkit_mol" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_rdkit_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_from_rdkit_mol</span></code></a>(self, mol)</p></td>
<td><p>Update the structure to match <cite>mol</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.write" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(self, path[, atom_ids])</p></td>
<td><p>Write the structure to a file.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">building_blocks</em>, <em class="sig-param">topology_graph</em>, <em class="sig-param">building_block_vertices=None</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>building_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>) – The <a class="reference internal" href="stk.molecular.molecules.building_block.html#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> and
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> instances which
represent the building block molecules used for
construction. Only one instance is present per building
block molecule, even if multiples of that building block
join up to form the <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>.</p></li>
<li><p><strong>topology_graph</strong> (<a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html#stk.molecular.topology_graphs.topology_graph.TopologyGraph" title="stk.molecular.topology_graphs.topology_graph.TopologyGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">TopologyGraph</span></code></a>) – Defines the topology graph of the
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> and constructs it.</p></li>
<li><p><strong>building_block_vertices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>, optional) – Maps the <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> in  <cite>building_blocks</cite> to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code> instances in
<cite>topology_graph</cite> it is placed on. Each
<a class="reference internal" href="stk.molecular.molecules.building_block.html#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> and <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>
can be mapped to multiple <code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code>
objects. See the examples section in the
<a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> class docstring to help
understand how this parameter is used. If <code class="docutils literal notranslate"><span class="pre">None</span></code>,
building block molecules will be assigned to vertices at
random.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> will
not be made if a cached and identical one already exists,
the one which already exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code>
and a cached, identical <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a> does
not yet exist the created one will be added to the cache.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_displacement">
<code class="sig-name descname">apply_displacement</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">displacement</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the centroid by <cite>displacement</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>displacement</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A displacement vector applied to the molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_about_axis">
<code class="sig-name descname">apply_rotation_about_axis</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">angle</em>, <em class="sig-param">axis</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_about_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate by <cite>angle</cite> about <cite>axis</cite> on the <cite>origin</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The origin about which the rotation happens.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_between_vectors">
<code class="sig-name descname">apply_rotation_between_vectors</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">start</em>, <em class="sig-param">target</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_between_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate by a rotation from <cite>start</cite> to <cite>target</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>target</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>target</cite>
onto the molecule. The rotation occurs about the <cite>origin</cite>.</p>
<p>For example, if the <cite>start</cite> and <cite>target</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>target</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms into
the <cite>target</cite> vector.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector onto which <cite>start</cite> is rotated.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The point about which the rotation occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_to_minimize_angle">
<code class="sig-name descname">apply_rotation_to_minimize_angle</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">start</em>, <em class="sig-param">target</em>, <em class="sig-param">axis</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.apply_rotation_to_minimize_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate to minimize the angle between <cite>start</cite> and <cite>target</cite>.</p>
<p>Note that this function will not necessarily overlay the
<cite>start</cite> and <cite>target</cite> vectors. This is because the possible
rotation is restricted to the <cite>axis</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is rotated.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is stationary.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The origin about which the rotation happens.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em>, <em class="sig-param">include_attrs=None</em>, <em class="sig-param">ignore_missing_attrs=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the  <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>
should be written.</p></li>
<li><p><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the representation. Each attribute is saved as a string
using <code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</p></li>
<li><p><strong>ignore_missing_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> and an attribute in <cite>include_attrs</cite> is not
held by the <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>, an error will be raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_coords">
<code class="sig-name descname">get_atom_coords</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield the coordinates of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms whose coordinates are desired.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the coordinates of all atoms will be
yielded.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The x, y and z coordinates of an atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_distance">
<code class="sig-name descname">get_atom_distance</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom1_id</em>, <em class="sig-param">atom2_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<p>This method does not account for the van der Waals radius of
atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</p></li>
<li><p><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The distance between the first and second atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_building_blocks">
<code class="sig-name descname">get_building_blocks</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_building_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield the building blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> – A building block of the <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_cached_mol">
<em class="property">classmethod </em><code class="sig-name descname">get_cached_mol</code><span class="sig-paren">(</span><em class="sig-param">identity_key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_cached_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a molecule from the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>identity_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>) – The identity key of the molecule to return.</p></li>
<li><p><strong>default</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>, optional) – Returned if <cite>identity_key</cite> is not found in the cache.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> an error will be raised if <cite>identity_key</cite> is
not found in the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cached molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_center_of_mass">
<code class="sig-name descname">get_center_of_mass</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centre of mass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
center of mass. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinates of the center of mass.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_centroid">
<code class="sig-name descname">get_centroid</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which are used to calculate the
centroid. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_direction">
<code class="sig-name descname">get_direction</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of best fit through the atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
vector. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The vector of best fit.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_identity_key">
<code class="sig-name descname">get_identity_key</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_identity_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the identity key.</p>
<p>The identity key wil be equal for two molecules which
<code class="docutils literal notranslate"><span class="pre">stk</span></code> sees as identical. The identity key does not take
the conformation into account but it does account for
isomerism.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A hashable object which represents the identity of the
molecule.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_maximum_diameter">
<code class="sig-name descname">get_maximum_diameter</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_maximum_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum diamater.</p>
<p>This method does not account for the van der Waals radius of
atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which are considered when looking for the
maximum diamater. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms in the
molecule are considered.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maximum diameter in the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_plane_normal">
<code class="sig-name descname">get_plane_normal</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normal to the plane of best fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
plane. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Vector orthonormal to the plane of the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_position_matrix">
<code class="sig-name descname">get_position_matrix</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.get_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix holding the atomic positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The array has the shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>. Each row holds the
x, y and z coordinates of an atom.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.has_cached_mol">
<em class="property">classmethod </em><code class="sig-name descname">has_cached_mol</code><span class="sig-paren">(</span><em class="sig-param">identity_key</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.has_cached_mol" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if molecule with <cite>identity_key</cite> is cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>identity_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>) – The identity key of a molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if a molecule with <cite>identity_key</cite> is cached.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.init_from_dict">
<em class="property">classmethod </em><code class="sig-name descname">init_from_dict</code><span class="sig-paren">(</span><em class="sig-param">mol_dict</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.init_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>mol_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation
of a molecule, generated by <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_dict()</span></code></a>.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new instance will not be made if a cached
and identical one already exists, the one which already
exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and a cached,
identical instance does not yet exist the created one will
be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule represented by <cite>mol_dict</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a dump file.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
in the file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>. You can use this if you
don’t know what class the instance in the loaded molecule is or
should be.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a dumped molecule.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new instance will not be made if a cached
and identical one already exists, the one which already
exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and a cached,
identical instance does not yet exist the created one will
be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule held in <cite>path</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_centroid">
<code class="sig-name descname">set_centroid</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">position</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the centroid to <cite>position</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule is going to be placed.</p></li>
<li><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which should have their centroid set to
<cite>position</cite>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_position_matrix">
<code class="sig-name descname">set_position_matrix</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">position_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.set_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the coordinates to those in <cite>position_matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A position matrix of the molecule. The shape of the matrix
is <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">include_attrs=None</em>, <em class="sig-param">ignore_missing_attrs=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of additional attributes of the molecule to be
added to the <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>. Each attribute is saved as a
string using <code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>. These attributes are also
passed down recursively to the building block molecules.</p></li>
<li><p><strong>ignore_missing_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> and an attribute in <cite>include_attrs</cite> is not
held by the <a class="reference internal" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>, an error will be
raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_rdkit_mol">
<code class="sig-name descname">to_rdkit_mol</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.to_rdkit_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The molecule in <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> format.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_cache">
<code class="sig-name descname">update_cache</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of the cached molecule.</p>
<p>If there is no identical molecule in the cache, then this
molecule is added.</p>
<p>When using multiprocessing, modified copies of the original
molecules are created. In order to ensure that the cached
molecules have their attributes updated to the values of the
copies, this method must be run on the copies.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_file">
<code class="sig-name descname">update_from_file</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the structure from a file.</p>
<p>Multiple file types are supported, namely:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mol</span></code>, <code class="docutils literal notranslate"><span class="pre">.sdf</span></code> - MDL V2000 and V3000 files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.xyz</span></code> - XYZ files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.mae</span></code> - Schrodinger Maestro files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.coord</span></code> - Turbomole files</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The path to a molecular structure file holding updated
coordinates for the <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_rdkit_mol">
<code class="sig-name descname">update_from_rdkit_mol</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.update_from_rdkit_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the structure to match <cite>mol</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> molecule to use for the structure update.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructedMolecule.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructedMolecule.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the structure to a file.</p>
<p>This function will write the format based on the extension
of <cite>path</cite>.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mol</span></code>, <code class="docutils literal notranslate"><span class="pre">.sdf</span></code> - MDL V3000 MOL file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.xyz</span></code> - XYZ file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pdb</span></code> - PDB file</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</p></li>
<li><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructionError">
<em class="property">exception </em><code class="sig-name descname">ConstructionError</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructionError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructionError.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">/</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructionError.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize self.  See help(type(self)) for accurate signature.</p>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructionError.args">
<code class="sig-name descname">args</code><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructionError.args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.constructed_molecule.ConstructionError.with_traceback">
<code class="sig-name descname">with_traceback</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.constructed_molecule.ConstructionError.with_traceback" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception.with_traceback(tb) –
set self.__traceback__ to tb and return self.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>