

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building Block &mdash; stk  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Developer Guide" href="developer_guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> stk
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">stk</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_examples.html">Basic Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_guide.html">Developer Guide</a></li>
</ul>
<p class="caption"><span class="caption-text">Molecules</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Building Block</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.molecules.constructed_molecule.html">Constructed Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.functional_groups.html">Functional Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.populations.html">Populations</a></li>
</ul>
<p class="caption"><span class="caption-text">Topology Graphs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.polymer.html">Polymer</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.cage.base.html">Organic Cage</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.cof.html">Covalent Organic Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.host_guest.html">Host Guest Complex</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.macrocycle.html">Macrocycle</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.rotaxane.html">Rotaxane</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.molecular.topology_graphs.topology_graph.html">Adding Topology Graphs</a></li>
</ul>
<p class="caption"><span class="caption-text">Calculators</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="calculators.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.optimization.optimizers.html">Optimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.energy.energy_calculators.html">Energy Calculators</a></li>
</ul>
<p class="caption"><span class="caption-text">Evolutionary Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ea.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.fitness_calculators.html">Fitness Calculators</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.fitness_normalizers.html">Fitness Normalizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.selectors.html">Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.mutators.html">Mutation</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.crossers.html">Crossover</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.terminators.html">Termination</a></li>
<li class="toctree-l1"><a class="reference internal" href="stk.calculators.ea.plotters.html">Plotting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">stk</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Building Block</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/stk.molecular.molecules.building_block.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-stk.molecular.molecules.building_block"></span><div class="section" id="building-block">
<h1>Building Block<a class="headerlink" href="#building-block" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="stk.molecular.molecules.building_block.BuildingBlock">
<em class="property">class </em><code class="sig-name descname">BuildingBlock</code><span class="sig-paren">(</span><em class="sig-param">smiles</em>, <em class="sig-param">functional_groups=None</em>, <em class="sig-param">random_seed=4</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">stk.molecular.molecules.molecule.Molecule</span></code></a></p>
<p>Represents a building block of a <a class="reference internal" href="stk.molecular.molecules.constructed_molecule.html#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>.</p>
<p>A <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> can represent either an entire molecule or
a molecular fragments used to construct a
<a class="reference internal" href="stk.molecular.molecules.constructed_molecule.html#stk.molecular.molecules.constructed_molecule.ConstructedMolecule" title="stk.molecular.molecules.constructed_molecule.ConstructedMolecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstructedMolecule</span></code></a>. The building block uses
<a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="stk.molecular.molecules.building_block.BuildingBlock.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a> to identify which atoms are modified during
construction. Available functional group types can be seen in
<a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.functional_group_types" title="stk.molecular.molecules.building_block.BuildingBlock.functional_group_types"><code class="xref py py-attr docutils literal notranslate"><span class="pre">functional_group_types</span></code></a>. Additional functional groups
can be added at runtime by adding a <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FGType" title="stk.molecular.functional_groups.FGType"><code class="xref py py-class docutils literal notranslate"><span class="pre">FGType</span></code></a> instance
into <code class="xref py py-data docutils literal notranslate"><span class="pre">stk.fg_types</span></code>. See <a class="reference internal" href="stk.molecular.functional_groups.html#adding-functional-groups"><span class="std std-ref">Adding Functional Groups</span></a> for
an example.</p>
<dl class="attribute">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.atoms">
<code class="sig-name descname">atoms</code><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>The atoms of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.elements.html#stk.molecular.elements.Atom" title="stk.molecular.elements.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.bonds">
<code class="sig-name descname">bonds</code><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>The bonds of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.bonds.html#stk.molecular.bonds.Bond" title="stk.molecular.bonds.Bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bond</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.func_groups">
<code class="sig-name descname">func_groups</code><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>The functional groups present in the molecule. The
id of a <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a> is its index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of <a class="reference internal" href="stk.molecular.functional_groups.html#stk.molecular.functional_groups.FunctionalGroup" title="stk.molecular.functional_groups.FunctionalGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionalGroup</span></code></a></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_displacement" title="stk.molecular.molecules.building_block.BuildingBlock.apply_displacement"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_displacement</span></code></a>(self, displacement)</p></td>
<td><p>Shift the centroid by <cite>displacement</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_about_axis" title="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_about_axis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_about_axis</span></code></a>(self, angle, axis, …)</p></td>
<td><p>Rotate by <cite>angle</cite> about <cite>axis</cite> on the <cite>origin</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_between_vectors" title="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_between_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_between_vectors</span></code></a>(self, start, …)</p></td>
<td><p>Rotate by a rotation from <cite>start</cite> to <cite>target</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_to_minimize_angle" title="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_to_minimize_angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_rotation_to_minimize_angle</span></code></a>(self, …)</p></td>
<td><p>Rotate to minimize the angle between <cite>start</cite> and <cite>target</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.dump" title="stk.molecular.molecules.building_block.BuildingBlock.dump"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dump</span></code></a>(self, path[, include_attrs, …])</p></td>
<td><p>Write a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation to a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_atom_distance" title="stk.molecular.molecules.building_block.BuildingBlock.get_atom_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_atom_distance</span></code></a>(self, atom1_id, atom2_id)</p></td>
<td><p>Return the distance between 2 atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_atom_positions" title="stk.molecular.molecules.building_block.BuildingBlock.get_atom_positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_atom_positions</span></code></a>(self[, atom_ids])</p></td>
<td><p>Yield the positions of atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_centroids" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_centroids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_centroids</span></code></a>(self[, fg_ids])</p></td>
<td><p>Yield the centroids of bonder atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_direction_vectors" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_direction_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_direction_vectors</span></code></a>(self[, fg_ids])</p></td>
<td><p>Yield the direction vectors between bonder centroids.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_distances" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_distances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_distances</span></code></a>(self[, fg_ids])</p></td>
<td><p>Yield distances between pairs of bonder centroids.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_ids" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_ids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_ids</span></code></a>(self[, fg_ids])</p></td>
<td><p>Yield ids of bonder atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_plane</span></code></a>(self[, fg_ids])</p></td>
<td><p>Return coeffs of the plane formed by the bonder centroids.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane_normal" title="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane_normal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bonder_plane_normal</span></code></a>(self[, fg_ids])</p></td>
<td><p>Return the normal to the plane formed by bonder centroids.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_cached_mol" title="stk.molecular.molecules.building_block.BuildingBlock.get_cached_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cached_mol</span></code></a>(identity_key[, default])</p></td>
<td><p>Get a molecule from the cache.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_center_of_mass" title="stk.molecular.molecules.building_block.BuildingBlock.get_center_of_mass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_center_of_mass</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the centre of mass.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_centroid" title="stk.molecular.molecules.building_block.BuildingBlock.get_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the centroid.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_centroid_centroid_direction_vector" title="stk.molecular.molecules.building_block.BuildingBlock.get_centroid_centroid_direction_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_centroid_centroid_direction_vector</span></code></a>(self)</p></td>
<td><p>Return the direction vector between the 2 molecular centroids.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_direction" title="stk.molecular.molecules.building_block.BuildingBlock.get_direction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_direction</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return a vector of best fit through the atoms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_identity_key" title="stk.molecular.molecules.building_block.BuildingBlock.get_identity_key"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_identity_key</span></code></a>(self)</p></td>
<td><p>Return the identity key.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_maximum_diameter" title="stk.molecular.molecules.building_block.BuildingBlock.get_maximum_diameter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_maximum_diameter</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the maximum diamater.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_plane_normal" title="stk.molecular.molecules.building_block.BuildingBlock.get_plane_normal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_plane_normal</span></code></a>(self[, atom_ids])</p></td>
<td><p>Return the normal to the plane of best fit.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.get_position_matrix" title="stk.molecular.molecules.building_block.BuildingBlock.get_position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_position_matrix</span></code></a>(self)</p></td>
<td><p>Return a matrix holding the atomic positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.has_cached_mol" title="stk.molecular.molecules.building_block.BuildingBlock.has_cached_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_cached_mol</span></code></a>(identity_key)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if molecule with <cite>identity_key</cite> is cached.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_dict" title="stk.molecular.molecules.building_block.BuildingBlock.init_from_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_from_dict</span></code></a>(mol_dict[, use_cache])</p></td>
<td><p>Initialize from a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_file" title="stk.molecular.molecules.building_block.BuildingBlock.init_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_from_file</span></code></a>(path[, functional_groups, …])</p></td>
<td><p>Initialize from a file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_random_file" title="stk.molecular.molecules.building_block.BuildingBlock.init_from_random_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_from_random_file</span></code></a>(file_glob[, …])</p></td>
<td><p>Initialize from a random file in <cite>file_glob</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_rdkit_mol" title="stk.molecular.molecules.building_block.BuildingBlock.init_from_rdkit_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_from_rdkit_mol</span></code></a>(mol[, …])</p></td>
<td><p>Initialize from an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.load" title="stk.molecular.molecules.building_block.BuildingBlock.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(path[, use_cache])</p></td>
<td><p>Initialize from a dump file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.set_centroid" title="stk.molecular.molecules.building_block.BuildingBlock.set_centroid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_centroid</span></code></a>(self, position[, atom_ids])</p></td>
<td><p>Set the centroid to <cite>position</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.set_position_matrix" title="stk.molecular.molecules.building_block.BuildingBlock.set_position_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_position_matrix</span></code></a>(self, position_matrix)</p></td>
<td><p>Set the coordinates to those in <cite>position_matrix</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.to_dict" title="stk.molecular.molecules.building_block.BuildingBlock.to_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_dict</span></code></a>(self[, include_attrs, …])</p></td>
<td><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.to_rdkit_mol" title="stk.molecular.molecules.building_block.BuildingBlock.to_rdkit_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_rdkit_mol</span></code></a>(self)</p></td>
<td><p>Return an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> representation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.update_cache" title="stk.molecular.molecules.building_block.BuildingBlock.update_cache"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_cache</span></code></a>(self)</p></td>
<td><p>Update attributes of the cached molecule.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.update_from_file" title="stk.molecular.molecules.building_block.BuildingBlock.update_from_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_from_file</span></code></a>(self, path)</p></td>
<td><p>Update the structure from a file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.update_from_rdkit_mol" title="stk.molecular.molecules.building_block.BuildingBlock.update_from_rdkit_mol"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_from_rdkit_mol</span></code></a>(self, mol)</p></td>
<td><p>Update the structure to match <cite>mol</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.write" title="stk.molecular.molecules.building_block.BuildingBlock.write"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write</span></code></a>(self, path[, atom_ids])</p></td>
<td><p>Write the structure to a file.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">smiles</em>, <em class="sig-param">functional_groups=None</em>, <em class="sig-param">random_seed=4</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a SMILES string.</p>
<p class="rubric">Notes</p>
<p>The molecule is given 3D coordinates with
<code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDGv2()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smiles</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A SMILES string of the molecule.</p></li>
<li><p><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional group types which are to be
added to <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="stk.molecular.molecules.building_block.BuildingBlock.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then no
functional groups are added.</p></li>
<li><p><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – Random seed passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">rdkit.ETKDGv2()</span></code></p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will
not be made if a cached and identical one already exists,
the one which already exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code>
and a cached, identical <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> does not
yet exist the created one will be added to the cache.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.apply_displacement">
<code class="sig-name descname">apply_displacement</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">displacement</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_displacement" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the centroid by <cite>displacement</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>displacement</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A displacement vector applied to the molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_about_axis">
<code class="sig-name descname">apply_rotation_about_axis</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">angle</em>, <em class="sig-param">axis</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_about_axis" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate by <cite>angle</cite> about <cite>axis</cite> on the <cite>origin</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – The size of the rotation in radians.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The axis about which the rotation happens.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The origin about which the rotation happens.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_between_vectors">
<code class="sig-name descname">apply_rotation_between_vectors</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">start</em>, <em class="sig-param">target</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_between_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate by a rotation from <cite>start</cite> to <cite>target</cite>.</p>
<p>Given two direction vectors, <cite>start</cite> and <cite>target</cite>, this method
applies the rotation required transform <cite>start</cite> to <cite>target</cite>
onto the molecule. The rotation occurs about the <cite>origin</cite>.</p>
<p>For example, if the <cite>start</cite> and <cite>target</cite> vectors
are 45 degrees apart, a 45 degree rotation will be applied to
the molecule. The rotation will be along the appropriate
direction.</p>
<p>The great thing about this method is that you as long as you
can associate a geometric feature of the molecule with a
vector, then the molecule can be rotated so that this vector is
aligned with <cite>target</cite>. The defined vector can be virtually
anything. This means that any geometric feature of the molecule
can be easily aligned with any arbitrary axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A vector which is to be rotated so that it transforms into
the <cite>target</cite> vector.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector onto which <cite>start</cite> is rotated.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The point about which the rotation occurs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_to_minimize_angle">
<code class="sig-name descname">apply_rotation_to_minimize_angle</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">start</em>, <em class="sig-param">target</em>, <em class="sig-param">axis</em>, <em class="sig-param">origin</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.apply_rotation_to_minimize_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate to minimize the angle between <cite>start</cite> and <cite>target</cite>.</p>
<p>Note that this function will not necessarily overlay the
<cite>start</cite> and <cite>target</cite> vectors. This is because the possible
rotation is restricted to the <cite>axis</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is rotated.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector which is stationary.</p></li>
<li><p><strong>axis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The vector about which the rotation happens.</p></li>
<li><p><strong>origin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – The origin about which the rotation happens.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em>, <em class="sig-param">include_attrs=None</em>, <em class="sig-param">ignore_missing_attrs=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path to the file to which the  <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>
should be written.</p></li>
<li><p><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of attributes of the molecule to be added to
the representation. Each attribute is saved as a string
using <code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</p></li>
<li><p><strong>ignore_missing_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> and an attribute in <cite>include_attrs</cite> is not
held by the <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>, an error will be raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>None</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.functional_group_types">
<code class="sig-name descname">functional_group_types</code><em class="property"> = ['amine', 'primary_amine', 'aldehyde', 'carboxylic_acid', 'amide', 'thioacid', 'alcohol', 'thiol', 'bromine', 'iodine', 'alkyne', 'terminal_alkene', 'boronic_acid', 'amine2', 'secondary_amine', 'diol', 'difluorene', 'dibromine', 'alkyne2', 'ring_amine']</em><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.functional_group_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_atom_distance">
<code class="sig-name descname">get_atom_distance</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom1_id</em>, <em class="sig-param">atom2_id</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_atom_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between 2 atoms.</p>
<p>This method does not account for the van der Waals radius of
atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the first atom.</p></li>
<li><p><strong>atom2_id</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The id of the second atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The distance between the first and second atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_atom_positions">
<code class="sig-name descname">get_atom_positions</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_atom_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield the positions of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of the atoms whose positions are desired.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the positions of all atoms will be
yielded.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The x, y and z coordinates of an atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_centroids">
<code class="sig-name descname">get_bonder_centroids</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield the centroids of bonder atoms.</p>
<p>A bonder centroid is the centroid of all bonder atoms in a
particular functional group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups to be used. The bonder
centroids will be yielded in this order.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all functional groups are used and
centroids are yielded in ascending order of functional
group id.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> – The centroid of a functional group.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_direction_vectors">
<code class="sig-name descname">get_bonder_direction_vectors</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_direction_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield the direction vectors between bonder centroids.</p>
<p>A bonder centroid is the centroid of all bonder atoms in a
particular functional group.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups to be used.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all functional groups are used.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – They yielded tuple has the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.2</span><span class="p">,</span> <span class="mf">43.3</span><span class="p">,</span> <span class="mf">9.78</span><span class="p">]))</span>
</pre></div>
</div>
<p>The first two elements of the tuple represent the ids
of the start and end fgs of the vector, respectively. The
array is the direction vector running between the
functional group positions.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_distances">
<code class="sig-name descname">get_bonder_distances</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield distances between pairs of bonder centroids.</p>
<p>A bonder centroid is the centroid of all bonder atoms in a
particular functional group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups to be used.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all functional groups are used.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> – A <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code> of the form <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">54,</span> <span class="pre">12.54)</span></code>.
The first two elements are the ids of the involved
functional groups and the third element is the distance
between them.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_ids">
<code class="sig-name descname">get_bonder_ids</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Yield ids of bonder atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups whose bonder atoms should be
yielded. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all bonder atom ids in the
<a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will be yielded.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code> – The id of a bonder atom.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane">
<code class="sig-name descname">get_bonder_plane</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Return coeffs of the plane formed by the bonder centroids.</p>
<p>A bonder centroid is the centroid of all bonder atoms in a
particular functional group.</p>
<p>A plane is defined by the scalar plane equation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">+</span> <span class="n">by</span> <span class="o">+</span> <span class="n">cz</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span>
</pre></div>
</div>
<p>This method returns the <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">d</span></code>
coefficients of this equation for the plane formed by the
bonder centroids. The coefficents <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code>
describe the normal vector to the plane. The coefficent <code class="docutils literal notranslate"><span class="pre">d</span></code>
is found by substituting these coefficients along with the
x, y and z variables in the scalar equation and
solving for <code class="docutils literal notranslate"><span class="pre">d</span></code>. The variables x, y and z are
substituted by the coordinates of some point on the plane. For
example, the position of one of the bonder centroids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups used to construct the plane.
If there are more than three, a plane of best fit through
the bonder centroids of the functional groups will be made.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all functional groups in the
<a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>This array has the form <code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d]</span></code> and represents the
scalar equation of the plane formed by the bonder
centroids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://tinyurl.com/okpqv6">https://tinyurl.com/okpqv6</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane_normal">
<code class="sig-name descname">get_bonder_plane_normal</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_bonder_plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normal to the plane formed by bonder centroids.</p>
<p>A bonder centroid is the centroid of all bonder atoms in a
particular functional group.</p>
<p>The normal of the plane is defined such that it goes in the
direction toward the centroid of the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of functional groups used to construct the plane.
If there are more than three, a plane of best fit through
the bonder centroids of the functional groups will be made.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all functional groups in the
<a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A unit vector which describes the normal to the plane of
the bonder centroids.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If there are not at least 3 functional groups, which is
necessary to define a plane.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_cached_mol">
<em class="property">classmethod </em><code class="sig-name descname">get_cached_mol</code><span class="sig-paren">(</span><em class="sig-param">identity_key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_cached_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a molecule from the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>identity_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>) – The identity key of the molecule to return.</p></li>
<li><p><strong>default</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>, optional) – Returned if <cite>identity_key</cite> is not found in the cache.
If <code class="docutils literal notranslate"><span class="pre">None</span></code> an error will be raised if <cite>identity_key</cite> is
not found in the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The cached molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_center_of_mass">
<code class="sig-name descname">get_center_of_mass</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centre of mass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
center of mass. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinates of the center of mass.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Center_of_mass">https://en.wikipedia.org/wiki/Center_of_mass</a></p>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_centroid">
<code class="sig-name descname">get_centroid</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the centroid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which are used to calculate the
centroid. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The centroid of atoms specified by <cite>atom_ids</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_centroid_centroid_direction_vector">
<code class="sig-name descname">get_centroid_centroid_direction_vector</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">fg_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_centroid_centroid_direction_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direction vector between the 2 molecular centroids.</p>
<p>The first molecular centroid is the centroid of the entire
molecule. The second molecular centroid is the of the
bonder atoms in the molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fg_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of functional groups to be used for calculating the
bonder centroid. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all functional groups are
used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The vector running from the centroid of the bonder atoms to
the molecular centroid.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_direction">
<code class="sig-name descname">get_direction</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_direction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector of best fit through the atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
vector. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The vector of best fit.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_identity_key">
<code class="sig-name descname">get_identity_key</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_identity_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the identity key.</p>
<p>The identity key wil be equal for two molecules which
<code class="docutils literal notranslate"><span class="pre">stk</span></code> sees as identical. The identity key does not take
the conformation into account but it does account for
isomerism.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A hashable object which represents the identity of the
molecule.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_maximum_diameter">
<code class="sig-name descname">get_maximum_diameter</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_maximum_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximum diamater.</p>
<p>This method does not account for the van der Waals radius of
atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which are considered when looking for the
maximum diamater. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms in the
molecule are considered.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The maximum diameter in the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_plane_normal">
<code class="sig-name descname">get_plane_normal</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_plane_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normal to the plane of best fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The ids of atoms which should be used to calculate the
plane. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all atoms will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Vector orthonormal to the plane of the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.get_position_matrix">
<code class="sig-name descname">get_position_matrix</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.get_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a matrix holding the atomic positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The array has the shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>. Each row holds the
x, y and z coordinates of an atom.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.has_cached_mol">
<em class="property">classmethod </em><code class="sig-name descname">has_cached_mol</code><span class="sig-paren">(</span><em class="sig-param">identity_key</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.has_cached_mol" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if molecule with <cite>identity_key</cite> is cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>identity_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>) – The identity key of a molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">True</span></code> if a molecule with <cite>identity_key</cite> is cached.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.init_from_dict">
<em class="property">classmethod </em><code class="sig-name descname">init_from_dict</code><span class="sig-paren">(</span><em class="sig-param">mol_dict</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
<cite>mol_dict</cite>, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol_dict</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> holding the <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation
of a molecule, generated by <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.to_dict" title="stk.molecular.molecules.building_block.BuildingBlock.to_dict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_dict()</span></code></a>.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new instance will not be made if a cached
and identical one already exists, the one which already
exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and a cached,
identical instance does not yet exist the created one will
be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule represented by <cite>mol_dict</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.init_from_file">
<em class="property">classmethod </em><code class="sig-name descname">init_from_file</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">functional_groups=None</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – <p>The path to a molecular structure file. Supported file
types are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mol</span></code>, <code class="docutils literal notranslate"><span class="pre">.sdf</span></code> - MDL V3000 MOL file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pdb</span></code> - PDB file</p></li>
</ol>
</div></blockquote>
</p></li>
<li><p><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional group types which are to be
added to <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="stk.molecular.molecules.building_block.BuildingBlock.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then no
functional groups are added.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will
not be made if a cached and identical one already exists,
the one which already exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code>
and a cached, identical <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> does not
yet exist the created one will be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The building block.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the file type cannot be used for initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.init_from_random_file">
<em class="property">classmethod </em><code class="sig-name descname">init_from_random_file</code><span class="sig-paren">(</span><em class="sig-param">file_glob</em>, <em class="sig-param">functional_groups=None</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_random_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a random file in <cite>file_glob</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_glob</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – A glob specifying files, one of which is used to initialize
a <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> at random.</p></li>
<li><p><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional group types which are to be
added to <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="stk.molecular.molecules.building_block.BuildingBlock.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then no
functional groups are added.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will
not be made if a cached and identical one already exists,
the one which already exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code>
and a cached, identical <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> does not
yet exist the created one will be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A random molecule from <cite>file_glob</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – If no files in <cite>file_glob</cite> could be initialized from.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.init_from_rdkit_mol">
<em class="property">classmethod </em><code class="sig-name descname">init_from_rdkit_mol</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">functional_groups=None</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.init_from_rdkit_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – The molecule.</p></li>
<li><p><strong>functional_groups</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of the functional group types which are to be
added to <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock.func_groups" title="stk.molecular.molecules.building_block.BuildingBlock.func_groups"><code class="xref py py-attr docutils literal notranslate"><span class="pre">func_groups</span></code></a>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then no
functional groups are added.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> will
not be made if a cached and identical one already exists,
the one which already exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code>
and a cached, identical <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a> does not
yet exist the created one will be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.load">
<em class="property">classmethod </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">use_cache=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize from a dump file.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code> returned has the class specified in
in the file, not <code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>. You can use this if you
don’t know what class the instance in the loaded molecule is or
should be.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The full path holding a dumped molecule.</p></li>
<li><p><strong>use_cache</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a new instance will not be made if a cached
and identical one already exists, the one which already
exists will be returned. If <code class="docutils literal notranslate"><span class="pre">True</span></code> and a cached,
identical instance does not yet exist the created one will
be added to the cache.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule held in <cite>path</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.set_centroid">
<code class="sig-name descname">set_centroid</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">position</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.set_centroid" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the centroid to <cite>position</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – This array holds the position on which the centroid of the
molecule is going to be placed.</p></li>
<li><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – The ids of atoms which should have their centroid set to
<cite>position</cite>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.set_position_matrix">
<code class="sig-name descname">set_position_matrix</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">position_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.set_position_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the coordinates to those in <cite>position_matrix</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>position_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>) – A position matrix of the molecule. The shape of the matrix
is <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.to_dict">
<code class="sig-name descname">to_dict</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">include_attrs=None</em>, <em class="sig-param">ignore_missing_attrs=False</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, optional) – The names of additional attributes of the molecule to be
added to the <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>. Each attribute is saved as a
string using <code class="xref py py-func docutils literal notranslate"><span class="pre">repr()</span></code>.</p></li>
<li><p><strong>ignore_missing_attrs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, optional) – If <code class="docutils literal notranslate"><span class="pre">False</span></code> and an attribute in <cite>include_attrs</cite> is not
held by the <a class="reference internal" href="#stk.molecular.molecules.building_block.BuildingBlock" title="stk.molecular.molecules.building_block.BuildingBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">BuildingBlock</span></code></a>, an error will be
raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code> which represents the molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.to_rdkit_mol">
<code class="sig-name descname">to_rdkit_mol</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.to_rdkit_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The molecule in <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> format.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.update_cache">
<code class="sig-name descname">update_cache</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.update_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Update attributes of the cached molecule.</p>
<p>If there is no identical molecule in the cache, then this
molecule is added.</p>
<p>When using multiprocessing, modified copies of the original
molecules are created. In order to ensure that the cached
molecules have their attributes updated to the values of the
copies, this method must be run on the copies.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NoneType</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.update_from_file">
<code class="sig-name descname">update_from_file</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.update_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the structure from a file.</p>
<p>Multiple file types are supported, namely:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mol</span></code>, <code class="docutils literal notranslate"><span class="pre">.sdf</span></code> - MDL V2000 and V3000 files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.xyz</span></code> - XYZ files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.mae</span></code> - Schrodinger Maestro files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.coord</span></code> - Turbomole files</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The path to a molecular structure file holding updated
coordinates for the <a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.update_from_rdkit_mol">
<code class="sig-name descname">update_from_rdkit_mol</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">mol</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.update_from_rdkit_mol" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the structure to match <cite>mol</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rdkit.Mol</span></code>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">rdkit</span></code> molecule to use for the structure update.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="stk.molecular.molecules.building_block.BuildingBlock.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">path</em>, <em class="sig-param">atom_ids=None</em><span class="sig-paren">)</span><a class="headerlink" href="#stk.molecular.molecules.building_block.BuildingBlock.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the structure to a file.</p>
<p>This function will write the format based on the extension
of <cite>path</cite>.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.mol</span></code>, <code class="docutils literal notranslate"><span class="pre">.sdf</span></code> - MDL V3000 MOL file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.xyz</span></code> - XYZ file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pdb</span></code> - PDB file</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – The <cite>path</cite> to which the molecule should be written.</p></li>
<li><p><strong>atom_ids</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">iterable</span></code> of <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, optional) – The atom ids of atoms to write. If <code class="docutils literal notranslate"><span class="pre">None</span></code> then all atoms
are written.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The molecule.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="stk.molecular.molecules.molecule.html#stk.molecular.molecules.molecule.Molecule" title="stk.molecular.molecules.molecule.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="developer_guide.html" class="btn btn-neutral float-left" title="Developer Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Lukas Turcani

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>